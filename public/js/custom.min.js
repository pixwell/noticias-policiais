jQuery.noConflict(),function(n){var t=n("#main-menu");n("#toggle-menu a").click(function(e){e.preventDefault(),t.toggle("slow")});var a=n("#form-registro"),s=n("#nome"),r=n("#cidade"),o=n("#titulo"),i=n("#texto"),l=n("#status-envio-ocorrencia");function c(e,t){return e.css({border:"1px solid red",color:"red"}).attr("placeholder",t),e.focus(function(){n(this).removeAttr("style").removeAttr("placeholder")}),!1}a.submit(function(e){e.preventDefault();var t={author:s.val(),categories_id:r.val(),title:o.val(),content:i.val()};if(t.author?t.categories_id?t.title?t.content||c(i,"Insira o texto da sua ocorrência."):c(o,"Insira um título para a sua ocorrência."):c(r,"Escolha a sua cidade."):c(s,"Insira seu nome."),!(s.val()&&r.val()&&o.val()&&i.val()))return!1;n.ajax({url:"/store-ocorrencia",type:"POST",data:t,beforeSend:function(){l.empty().hide().html('<p class="status-processing">Enviando ...</p>').slideDown()},success:function(e){l.empty().hide().html(e).slideDown(),a.get(0).reset()},error:function(e){l.empty().html(e)}})});var u=n("#form-login"),d=n("#login"),m=n("#password"),v=n("#status-login");u.submit(function(e){e.preventDefault();var t={login:d.val(),password:m.val()};if(t.login?t.password||c(m,"Insira a sua senha."):c(d,"Insira seu login."),!d.val()||!m.val())return!1;n.ajax({url:"/auth",type:"POST",data:t,beforeSend:function(){v.empty().hide().html('<p class="status-processing">Enviando ...</p>').slideDown()},success:function(e){v.empty().hide();var t=JSON.parse(e);t.status?(u.get(0).reset(),window.location.href=t.redirect):v.empty().hide().html(t.mensagem).slideDown()},error:function(){v.empty().hide().html('<div class="status-fail">Erro ao fazer login.</div>').slideDown()}})});var p=n("#form-create-user"),f=(s=n("#nome"),d=n("#login"),n("#pass1")),h=n("#pass2"),g=n("#status-user");p.submit(function(e){e.preventDefault();var t={name:s.val(),login:d.val(),password:f.val()};if(t.name?t.login?f.val()?h.val()||c(h,""):c(f,""):c(d,"Insira um Login"):c(s,"Insira seu nome"),f.val()&&h.val()){if(f.val()!==h.val())return g.empty().hide().html('<p class="status-fail">As senhas <strong>NÃO</strong> combinam. Por favor, corrija para prosseguir.</p>').slideDown(),!1;t.password=f.val(),g.slideDown("slow",function(){n(this).empty()})}if(!(d.val()&&f.val()&&h.val()))return!1;n.ajax({url:"/store-user",type:"POST",data:t,beforeSend:function(){g.empty().hide().html('<p class="status-processing">Enviando ...</p>').slideDown()},success:function(e){var t=JSON.parse(e);g.empty().hide().html(t.mensagem).slideDown(),t.status&&p.get(0).reset()},error:function(){g.empty().html('<div class="status-fail">Erro ao fazer login.</div>')}})}),n(".btn-status").on("click",function(e){e.preventDefault();var t=n(this).data("id"),a=n(this);n.ajax({url:"/admin/"+t+"/change-status",type:"POST",data:{id:t},beforeSend:function(){a.hasClass("btn-success")&&a.removeClass("btn-success").addClass("btn-processing"),a.empty().html('<svg style="margin: 0;"><use href="#loader" /></svg>')},success:function(e){var t=JSON.parse(e);a.empty().removeClass("btn-success btn-processing").removeAttr("style").css("margin-right","5px").addClass(t.class).html(t.content)},error:function(){a.empty().removeClass("btn-success btn-processing").removeAttr("style").css("margin-right","5px").html('<div class="btn-processing">Erro!</div>')}})});n(".btn-delete");var y=n("#confirm-delete"),b=n("#confirm-delete #btn-delete"),e=n(".open-modal"),w=500;e.on("click",function(e){e.preventDefault();var t=n(this).data("id");b.removeAttr("data-id").attr("data-id",t),y.modal({fadeDuration:w})}),b.click(function(e){e.preventDefault();var t=n(this).attr("data-id"),a=n("#item-"+t),s=b.html();n.ajax({url:"/admin/"+t+"/delete",type:"POST",data:{id:t},beforeSend:function(){b.empty().html('<svg style="margin: 0; width: 16px; height: 16px;"><use href="#loader" /></svg>')},success:function(e){n.modal.close(),setTimeout(function(){a.css("background","#ffe0e0").slideUp(w),b.empty().html(s)},w)},error:function(){n.modal.close(),setTimeout(function(){alert("Erro ao deletar notícia!")},w)}})})}(jQuery);